#compdef cicd
#
#  Completion script for cicd

local ret=1

_zone () {compadd dev testing staging prod}

_1commands=(
   'console:open the cicd console'
   'stack:target all nodes in a stack'
   'node:target one specific node'
   'result:display command result'
)

_2stackcommand () {
    case $words[3] in
        stack)
            local -a options
            options=('facts:return static facts'
                     'data:return configuration data by key'
                     'ping:ping nodes'
                     'runpuppet:apply puppet configuration on subgroup.role'
                     'sync:sync data between minions and the saltmaster'
                     'orch:apply a orchestration command'
                    )
            _describe 'values' options && ret=0
            ;;
        node)
            local -a options
            options=('facts:return static facts'
                     'data:return configuration data'
                     'runpuppet:apply puppet configuration'
                    )
            _describe 'values' options && ret=0
            ;;
        result)
            local -a options
            options=('-j:job id'
                     '-n: number of result to display'
                    )
            _describe 'values' options && ret=0
            ;;
    esac
}


if (( CURRENT == 2 )); then
    _zone && ret=0
fi

if (( CURRENT == 3 )); then
    _describe -t commands 'value' _1commands && ret=0
fi

if (( CURRENT == 4 )); then
    _2stackcommand
fi

return ret
